# Linux ерунда заметки.

**wall** —  отображает сообщение на терминалах всех вошедших в систему пользователей. wall "message"

**write** - отображает сообщение на терминале конкретного пользователя.  echo "ughiug" | write test1

**w** - посмотреть пользователей в системе. или **who**

**/etc/nologin** - наличие данного файла запрещает вход всем пользователям кроме root

**gpart** - пытается угадать, какие разделы находятся на жестком диске. Если основная таблица разделов 
 была утеряна, перезаписана или уничтожена, разделы все еще существуют на диске, но 
 операционная система не может получить к ним доступ.

**/user/lib/systemd/system** - config file service

**arping** -c 1 -I eth1 192.168.1.10 - отправляет arp запрос.

**tcpdump** -i any arp -nn -v -A -e - перехватывает сетевой трафик проходящий через интерфейс.

**ls -l**

**/etc/passwd**

**/etc/group**

**/etc/sudoers** 

**visudo** - редактировать файл **/etc/sudoers**

sudo visudo -cf /etc/sudoers - проверить файл на соответствие синтаксиса.

**pam _ ssh _ agent_auth** - пакет PAM 

**Пример sudoers**

%wheel ALL = (ALL) ALL - член группы wheel может запустить любую программу с паролем.

MYSQL_ADMINS ALL = (mysql) NOPASSWD: ALL - администраторы mysql могут запускать любую команду под пользователем mysql без пароля.

ADMINS ALL =  (ALL) NOPASSWD: /usr/sbin/logrotate - администраторы могут запускать команду logrotate как обычный пользователь без пароля.


**sudo systemctl set-default multi-user.target** - изменить цель загрузки по умолчанию.

**sudo systemctl isolate multi-user.tarqet/rescue** - изменить текущую цель загрузки.

**systemctl list-units --type = target** - посмотреть доступные цели загрузки.

**passwd** - изменение пароля пользователя.

passwd -l - блокирует учетную запись добавляя знак ! к зашифрованному паролю.

sudo passwd -u root - разблокировать учетную запись пользователя root.

**SCP**

scp /home/user/file root@timeweb:/root/ - копирование туда.

scp -r /home/user/photos root@timeweb:/root/ - копирование директории.

scp -r /home/user/photos root@timeweb:/root/ - копирование директории.

scp root@timeweb:/root/file /home/user/ - копирование обратно


## Управление процессами

kill pid

kilall nano

### PS

ps up '1063 1056' - вывести информацию по конкетным PID.

ps aux

ps lax

ps aux | grep -v grep | grep sshd - удалить из вывода сам grep

**pidof nano** - выведет PID всех процессов nano

**pgrep nano** - выведет PID всех процессов nano

### Утилиты

**df -h** - загрузка жестких дисков и файловой системы.

**du -h** - размер файлов.

**uptime** - средняя нагрузка системы.

**top** - выводит список работающих в системе процессов.

**atop** - продвинутый интерактивный полноэкранный монитор производительностит.

**mpstat** -  выводит статистику по процессору.

**iostat** -  мониторит использование дисковых разделов.

**pidstat** - выводит статистику по процессам.

**vmstat** - выводит статистику процессора, памяти и о процессах.

**lvm** - инструмент для работы LVM.

**mdraid** - для работы с массивами дисков.

### Приоритет

**Приоритет процессора**

nice -n 5 ~/bin/lonqtask 

renice -5 8829

renice 5 -u boqqs

**Приоритет ввода-вывода**

ionice

**Отслеживание системных вызовов**

sudo strace -р 5810

truss ср /etc/passwd /Mgh/рw

**cron** **systemd timers**


## Файловая система

**mount** - все смонтированные файловые системы.

**mount** - с аргументами, примонтировать ФС.

**unmount** - отмонтировать. -f - принудительно отмонтировать использующуюся ФС.

**/etc/fstab** - смотированные файловые системы (блочные устройства /dev/..).

**fuser -сv /home** - посмотреть процессы использующие ФС. 

**lsof** - посмотреть процессы использующие ФС -u user - файлы используемые пользователем. -p 1042 - файлы используемые процессом.

**file** **ls -ld** - посмотреть тип файла. 

**rm -i** - удалить с подтверждением.

**ln** - создать жескую ссылку.

**ln -s** - создать символьную ссылку.

**chmod** - измениние прав пользования.

**chown user /file** - променять владельца. **chown user:grup /file** - променять владельца и группу.

**chqrp group /file** - поменять группу.


## Сценарии

**Ctrl+A** - начало строки **Ctrl+E** - конец строки

**echo $?** - код завершения последней операции.

**if**

if [...] then

команда

elif # иначе если

else # иначе

команда

if

![scrin](https://github.com/MalovAleksey/Linux/blob/main/skript/2024-03-05_14-56-34.png).

![script](https://github.com/MalovAleksey/Linux/blob/main/skript/2024-03-05_15-02-01.png).

**STDIN(0)** ввод **STDOUT(1)** - вывод в терминал **STDERR(2)**- ошибки

**>** - записать в файл **>>** - дописать в файл **2>** - направить ошибки.

**cut** 

- cut -b 1-4 -вырезать 1-4 байт строки. -с - вырезать символ
- 
-  cut -b 4- -вырезат все начиная с 4 байта.
-  
-  cut -b -4 -вырезат все начиная до 4 байта.
-  
-  cut -d: -f1 /etc/passwd - вырезать первый столбец, разрелитель :

**sort** 

- sort -t: -k3 -n /etc/group - отсортировать по третьему столбцу, -n числовая сортировка, -u -вывести уникальные значения.

**uniq** 
-c - посчитать количество экземпляров каждой строки

-d отобразить только дубликаты

-u -уникальные

 cut -d: -f7 /etc/passwd | sort | uniq -c - 

 **wc** /etc/group - посчитать количество строк, слов, байт

 -с - размер объекта в байтах

 -m -количество символов

 -l -количество строк

 -w - количество слов

 **head**

 **teil**

 -f - вывести в новь поступившие строки. Просмотр логов в реальном времени.
 
 -n - указать количество строк.
 
 -q - не выводить имя файла.

 **less** - для просмотра многостраничных файлов.

**grep**

-c - вывести количество совпаиших строк.

-l - только имена файлов совпавшие с шаблоном.

-v - отличающиеся от шаблона строки.

-i - игнорировать регистр.

 **fc** - передать последнюю команду в терминале в файл.

 **read** - приглашение ввода данных.

  **&&** - логическое И, **||** - логическое ИЛИ, следующая команда выполнится только если предыдущая ренула не 0

  **" \ "** - перенос команды на следующую строку.

  **mkdir foo; cd foo; touch file1** - последовательное выполнение нескольких команд.

Присвоение переменных

**variable=1 

echo ${variable}

1**

**Пример с кавычками**

$ mylang="Pennsylvania Dutch"

$ echo "I speak ${mylang}."

I speak Pennsylvania Dutch.

$ echo 'I speak ${mylang}.'

I speak $(mylang). 

**Бэктики**

$ echo "Тhere are `wc -1 < /etc/passwd` lines in the passwd file." -в бэктиках выполнится командв и выведется её результат.

There are 28 lines in the passwd file. 

**Переменные окружения**

**printrnv** - посмотреть все переменные.

**export EDITOR=/user/bin/nano** - назначить значение переменной среды.











